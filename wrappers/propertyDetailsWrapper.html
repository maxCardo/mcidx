<!DOCTYPE html>
<html lang="en" class="search-results-page">

<head>
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src =
            'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-KXR996T');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://maxcardo.github.io/mcidx/fonts/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://maxcardo.github.io/mcidx/assets/css/slick.css"/>
    <link rel="stylesheet" type="text/css" href="https://maxcardo.github.io/mcidx/assets/css/slick-theme.css"/>
    <link rel="stylesheet" href="https://maxcardo.github.io/mcidx/style.css">
    <link rel="stylesheet" href="https://maxcardo.github.io/mcidx/assets/css/waves.min.css">
    <title>Fifth & Grant Real Estate Services</title>
</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXR996T" height="0" width="0"
            style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->
<div class="global-wrapper">
    <!-- sidepanel -->
    <div class="menu">
        <ul class="menu__links">
            <li>
                <a href="https://maxcardo.github.io/mcidx" class="menu__link"><i class="fa fa-home"></i> Home</a>
            </li>
            <li>
                <a href="http://cardo.idxbroker.com/idx/search" class="menu__link"><i class="fa fa-search"></i>
                    Search</a>
            </li>
            <li>
                <a href="http://cardo.idxbroker.com/idx/map/mapsearch" class="menu__link"><i
                        class="fa fa-map-marker"></i> Map Search</a>
            </li>
            <li>
                <a href="https://maxcardo.github.io/mcidx/contact.html" class="menu__link"><i
                        class="fa fa-envelope"></i> Contact Us</a>
            </li>

            <li>
                <a href="tel:412-444-5181" class="menu__link"><i class="fa fa-phone"></i>Call Us</a>
            </li>
        </ul>
    </div>

    <div class="menu__toggler--container">
        <!-- hamburger menu -->
        <div class="menu__toggler"><span></span></div>
        <div class="header__logo--mobile">
            <a href="https://maxcardo.github.io/mcidx">
                <img src="https://maxcardo.github.io/mcidx/images/small.png" alt="" class="logo">
            </a>
        </div>
    </div>

    <!-- header -->
    <header class="header" id="header">
        <div class="container">
            <div class="header__logo">
                <a href="https://maxcardo.github.io/mcidx">
                    <img src="https://maxcardo.github.io/mcidx/images/small.png" alt="" class="logo">
                </a>
            </div>
            <ul class="header__links">
                <li>
                    <a href="http://cardo.idxbroker.com/idx/search" class="header__link link"><i
                            class="fas fa-search"></i> Search
                        <div></div>
                    </a>
                </li>
                <li>
                    <a href="http://cardo.idxbroker.com/idx/map/mapsearch" class="header__link link"><i
                            class="fas fa-map-marker-alt"></i> Map Search
                        <div></div>
                    </a>
                </li>
                <li>
                    <a href="https://maxcardo.github.io/mcidx/contact.html" class=" header__link link"><i
                            class="fas fa-envelope"></i> Contact Us
                        <div></div>
                    </a>
                </li>

                <li>
                    <a href="tel:412-444-5181" class="header__link link"><i class="fas fa-phone"></i> 412-444-5181
                        <div></div>
                    </a>
                </li>
            </ul>
        </div>
    </header>
    <!-- Header with full-height image -->
    <div class="bgimg-1 w3-display-container w3-grayscale-min" id="idxStart"></div>
    <div id="idxStop"></div>
</div>

<script type="text/javascript" src="https://maxcardo.github.io/mcidx/assets/js/jquery.min.js"></script>
<script type="text/javascript" src="https://maxcardo.github.io/mcidx/assets/js/slick.min.js"></script>
<script type="text/javascript" src="https://maxcardo.github.io/mcidx/idxMain.js"></script>
<script src="https://maxcardo.github.io/mcidx/assets/js/waves.min.js"></script>

<script>
    $(document).ready(function () {

        const theUserToolbar = $("#IDX-leadToolsBar");

        if (theUserToolbar) {

            const closeBtn = '<svg aria-hidden="true" focusable="true" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';

            const userIcon = '<svg aria-hidden="true" focusable="true" data-prefix="fas" data-icon="user" class="svg-inline--fa fa-user fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"></path></svg>';

            theUserToolbar.prepend(userIcon);
            theUserToolbar.prepend(closeBtn);

            $('#IDX-leadToolsBar svg:nth-child(2)').on('click', function() {
                theUserToolbar.toggleClass('open');
            });
            $('#IDX-leadToolsBar svg:first-child').on('click', function() {
                theUserToolbar.removeClass('open');
            });
        }


        $('#IDX-saveSearch, .IDX-newSearch, .IDX-modifySearch, #IDX-refineSearchFormToggle, #IDX-resultsRefineSubmit, .IDX-btn--map-toggle')
            .addClass('btn');

        /*Area field in property details box*/
        const areaName = $('#IDX-field-mlsareamajor .IDX-text').text().trim();
        const areaElement = '<div class="IDX-field-area IDX-field ">' +
                '<span class="IDX-label">Area</span>' +
                '<span class="IDX-text">' + areaName + '</span>' +
            '</div>';
        $('.IDX-field-propStatus.IDX-field').after(areaElement);

        /**
         * @return {boolean}
         */
        function ValidateEmail(uemail)
        {
            var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
            return !!uemail.match(mailformat);
        }

        /* Signup Page Form */

        $("#IDX-signupForm #IDX-submitBtn").on('click', function() {

            const firstName = $("#IDX-firstName").val();
            const lastName = $("#IDX-lastName").val();
            const email = $("#IDX-email").val();
            const phone = $("#IDX-phone").val();

            /*change here with API route*/
            const APIUrl = "https://06edd359e187.ngrok.io/api/marketPlace/web/newuser";

            if (ValidateEmail(email) && firstName.trim().length > 3 && firstName.trim().length < 16 && lastName.trim().length > 3 && lastName.trim().length < 20) {

                $.ajax({
                    url: APIUrl,
                    type: "POST",
                    crossDomain: true,
                    dataType: "json",
                    data: {
                        firstName: firstName,
                        lastName: lastName,
                        email: email,
                        phone: phone,
                    },
                    success: function (data, textStatus, jqXHR) {
                        //data - response from server
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log('it errored');
                    }
                });
            } else {
                console.log("failed cause form is invalid!");

            }
        });
        /* END OF Signup Page Form */

        Waves.init();
        Waves.attach('.btn');

        if ($('.bushafSlider')) {
            $('.bushafSlider').slick({
                dots: true,
                infinite: true,
                speed: 300,
                slidesToShow: 1,
                centerMode: true,
                variableWidth: true
            });
        }

        $.urlParam = function (name) {
            var results = new RegExp('[\?&]' + name + '=([^&#]*)')
                .exec(window.location.search);

            return (results !== null) ? results[1] || 0 : false;
        };


        const mode = $.urlParam('mode');
        const buyerID = $.urlParam('bid');
        const propertyID = window.location.pathname.split("/").pop();
        let visited, liked = null;

        /* recomendation links code */
        if (mode === "recommend") {
            $('#IDX-detailsWrapper').addClass('recommend');
            $('#IDX-saveProperty').remove();

            let userData = {
                bid: buyerID,
                liked: null,
                propertyID: propertyID
            };

            /* TODO: change api url*/
            const apiURL = 'https://06edd359e187.ngrok.io/api/marketPlace/web/deal/';

            $.ajax({
                url : (apiURL + 'view'),
                type: "POST",
                crossDomain: true,
                dataType: "json",
                data : {
                    bid: buyerID,
                    propertyID: propertyID,
                    viewed: true
                },
                success: function(data, textStatus, jqXHR)
                {
                    //data - response from server
                    /* TODO: second ajax call from user story */
                },
                error: function (jqXHR, textStatus, errorThrown)
                {
                    console.log('it errored');
                }
            });

            const userFeedbackElement = '<div class="alert alert__client-feedback">' +
                    '<div class="client-feedback__items">' +
                        '<div class="client-feedback__item">' +
                        '<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="thumbs-up" class="svg-inline--fa fa-thumbs-up fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M466.27 286.69C475.04 271.84 480 256 480 236.85c0-44.015-37.218-85.58-85.82-85.58H357.7c4.92-12.81 8.85-28.13 8.85-46.54C366.55 31.936 328.86 0 271.28 0c-61.607 0-58.093 94.933-71.76 108.6-22.747 22.747-49.615 66.447-68.76 83.4H32c-17.673 0-32 14.327-32 32v240c0 17.673 14.327 32 32 32h64c14.893 0 27.408-10.174 30.978-23.95 44.509 1.001 75.06 39.94 177.802 39.94 7.22 0 15.22.01 22.22.01 77.117 0 111.986-39.423 112.94-95.33 13.319-18.425 20.299-43.122 17.34-66.99 9.854-18.452 13.664-40.343 8.99-62.99zm-61.75 53.83c12.56 21.13 1.26 49.41-13.94 57.57 7.7 48.78-17.608 65.9-53.12 65.9h-37.82c-71.639 0-118.029-37.82-171.64-37.82V240h10.92c28.36 0 67.98-70.89 94.54-97.46 28.36-28.36 18.91-75.63 37.82-94.54 47.27 0 47.27 32.98 47.27 56.73 0 39.17-28.36 56.72-28.36 94.54h103.99c21.11 0 37.73 18.91 37.82 37.82.09 18.9-12.82 37.81-22.27 37.81 13.489 14.555 16.371 45.236-5.21 65.62zM88 432c0 13.255-10.745 24-24 24s-24-10.745-24-24 10.745-24 24-24 24 10.745 24 24z"></path></svg>' +
                        '</div>' +
                        '<h4>Tell us what you think</h4>' +
                        '<div class="client-feedback__item">' +
                        '<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="thumbs-down" class="svg-inline--fa fa-thumbs-down fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M466.27 225.31c4.674-22.647.864-44.538-8.99-62.99 2.958-23.868-4.021-48.565-17.34-66.99C438.986 39.423 404.117 0 327 0c-7 0-15 .01-22.22.01C201.195.01 168.997 40 128 40h-10.845c-5.64-4.975-13.042-8-21.155-8H32C14.327 32 0 46.327 0 64v240c0 17.673 14.327 32 32 32h64c11.842 0 22.175-6.438 27.708-16h7.052c19.146 16.953 46.013 60.653 68.76 83.4 13.667 13.667 10.153 108.6 71.76 108.6 57.58 0 95.27-31.936 95.27-104.73 0-18.41-3.93-33.73-8.85-46.54h36.48c48.602 0 85.82-41.565 85.82-85.58 0-19.15-4.96-34.99-13.73-49.84zM64 296c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zm330.18 16.73H290.19c0 37.82 28.36 55.37 28.36 94.54 0 23.75 0 56.73-47.27 56.73-18.91-18.91-9.46-66.18-37.82-94.54C206.9 342.89 167.28 272 138.92 272H128V85.83c53.611 0 100.001-37.82 171.64-37.82h37.82c35.512 0 60.82 17.12 53.12 65.9 15.2 8.16 26.5 36.44 13.94 57.57 21.581 20.384 18.699 51.065 5.21 65.62 9.45 0 22.36 18.91 22.27 37.81-.09 18.91-16.71 37.82-37.82 37.82z"></path></svg>' +
                        '</div>' +
                    '</div>' +
                '</div>';

            $("#IDX-detailsMainInfo").prepend(userFeedbackElement);


            $('.client-feedback__item svg.fa-thumbs-up').on('click', function(){
                userData.liked = true;
                $('#IDX-detailsWrapper').removeClass('recommend');


                $.ajax({
                    url : (apiURL + 'like'),
                    type: "POST",
                    crossDomain: true,
                    dataType: "json",
                    data : userData,
                    success: function(data, textStatus, jqXHR)
                    {
                        $('#IDX-detailsWrapper').removeClass('recommend');
                        $('.alert__client-feedback').remove();
                        //data - response from server

                        /* TODO: second ajax call from user story */
                    },
                    error: function (jqXHR, textStatus, errorThrown)
                    {
                        console.log('it errored');
                    }
                });

                $('.alert__client-feedback').remove();
            });

            $('.client-feedback__item svg.fa-thumbs-down').on('click', function(){
                userData.liked = false;
                $('#IDX-detailsWrapper').removeClass('recommend');


                $.ajax({
                    url : apiURL + 'like',
                    type: "POST",
                    crossDomain: true,
                    dataType: "json",
                    data : userData,
                    success: function(data, textStatus, jqXHR)
                    {
                        $('.alert__client-feedback').remove();
                    },
                    error: function (jqXHR, textStatus, errorThrown)
                    {
                        console.log('it errored');
                    }
                });

                $('.alert__client-feedback').remove();

            });

        }

    });
</script>
</body>

</html>