{% import "detailsTools-1.002.twig" as tools %}

{# main idx page content here #}
{% block idxContent %}
    {% spaceless %}
        {# page specific content #}
        {% if mlsRules.remarksPrefixText and mlsRules.remarksPrefixField %}
            {% set remarksConcat = mlsRules.remarksPrefixText ~ ' ' ~ attribute(_context, mlsRules.remarksPrefixField) ~ ' - ' ~ remarksConcat %}
        {% endif %}

        <div id="IDX-detailsWrapper" class="IDX-pageContainer"
             data-collapse-details="{{ collapseMobileFirstDetailsFields }}">

            <div class="detailsWrapper--left">

                {% if missingProperty %}
                <p id="IDX-detailsMissingPropertyAlert" class="IDX-missingPropertyAlert IDX-alert">We're sorry! The
                    property you tried to view does not seem to exist. This could be because the property has left
                    market and entered a Sold or Pending state. If you would like more information about properties
                    similar to the one you were trying to find, please contact <a id="IDX-missingPropertyContactLink"
                                                                                  href="{{ contactPageURL }}">{{ displayName }}</a>.
                    You can also try performing a <a id="IDX-missingPropertyNewSearchLink" href="{{ newSearchURL }}">New
                        Search</a>!</p>
                {% elseif propArchived %}
                <p id="IDX-detailsMissingPropertyAlert" class="IDX-missingPropertyAlert IDX-alert">We're sorry! The
                    property at {{ address }} in {{ cityName }} , {{ state }} currently has an unknown property status.
                    This could be because the property is pending sale, sold, or is off the market. If you would like
                    more information about properties similar to {{ address }} in {{ cityName }}, {{ state }}, please
                    contact <a id="IDX-missingPropertyContactLink" href="{{ contactPageURL }}">{{ displayName }}</a>.
                    You can also try performing a <a id="IDX-missingPropertyNewSearchLink" href="{{ newSearchURL }}">New
                        Search</a>!</p>
                {% elseif invalidMLS %}
                <p id="IDX-detailsInvalideMlsAlert" class="IDX-alert">This account does not have permission to show the
                    requested MLS's data.</p>
                {% else %}
                <div id="IDX-details-row-content" class="IDX-row-content">


                    <div id="IDX-detailsHead">
                        <div id="IDX-detailsMediaContaner--custom">
                            {% block idxDetailsHeader %}
                                <div id="IDX-detailsTopNav"
                                     {% if nav.prev or nav.next %}class="IDX-detailsTrack"{% endif %}>

                                    <nav id="IDX-navbar"
                                         class="IDX-navbar IDX-navbar-default IDX-navbar-default--neutral"
                                         role="navigation">
                                        <div class="IDX-container-navbar">
                                            <!-- Brand and toggle get grouped for better mobile display -->
                                            <div class="IDX-navbar-header">
                                                <div class="flex-grow"></div>
                                                <button type="button" class="IDX-navbar-toggle IDX-collapsed"
                                                        data-toggle="idx-collapse"
                                                        data-target="#IDX-navbar-collapse">
                                                    <span class="sr-only">Toggle navigation</span>
                                                    <span class="IDX-icon-bar"></span>
                                                    <span class="IDX-icon-bar"></span>
                                                    <span class="IDX-icon-bar"></span>
                                                </button>
                                            </div><!-- Collect the nav links, forms, and other content for toggling -->
                                            <div class="IDX-collapse IDX-navbar-collapse" id="IDX-navbar-collapse">
                                                <ul class="IDX-nav IDX-navbar-nav">

                                                    {% if nav.prev or nav.next %}
                                                        <li class="IDX-searchNavItem IDX-nav-propertyArrows">
                                                        <div class="IDX-searchNavItem IDX-nav-advanced IDX-prevProperty">

                                                            <a href="{{ detailsBaseURL }}{{ nav.prev.detailsURL }}"
                                                               class="IDX-btn IDX-btn-default {% if not nav.prev %}disabled{% endif %}"
                                                               {% if not nav.prev %}disabled={% endif %}>
                                                                <i class="fa fa-chevron-left"></i>
                                                            </a>
                                                        </div>
                                                        {% if nav.prev or nav.next %}
                                                            <div class="IDX-searchNavItem IDX-nextProperty">
                                                                {% if nav.next %}
                                                                    <a href="{{ detailsBaseURL }}{{ nav.next.detailsURL }}"
                                                                       class="IDX-btn IDX-btn-default">
                                                                        <i class="fa fa-chevron-right"></i>
                                                                    </a>
                                                                {% endif %}
                                                            </div>
                                                        {% endif %}
                                                        </li>
                                                    {% endif %}


                                                    {% spaceless %}
                                                        {% if missingProperty == false and propArchived == false %}
                                                            <li class="IDX-searchNavItem IDX-nav-listingid">
                                                                {% if propertySavedPreviously %}
                                                                    <a id="IDX-saveProperty"
                                                                       data-listingid="{{ listingID }}"
                                                                       data-idxid="{{ idxID }}" href="#saveProperty"
                                                                       class="IDX-saveProperty IDX-btn IDX-btn-default">Saved!</a>
                                                                {% else %}
                                                                    <a id="IDX-saveProperty"
                                                                       data-listingid="{{ listingID }}"
                                                                       data-idxid="{{ idxID }}" href="#saveProperty"
                                                                       class="IDX-saveProperty IDX-btn IDX-btn-default">Save
                                                                        Property</a>
                                                                {% endif %}
                                                            </li>
                                                        {% endif %}
                                                        {% if nav.newSearch %}

                                                            <li class="IDX-searchNavItem IDX-nav-address">
                                                                <a id="IDX-newSearch" href="{{ nav.newSearch }}"
                                                                   class="IDX-btn IDX-btn-default">New
                                                                    Search</a>
                                                            </li>

                                                        {% endif %}
                                                        {% if nav.modifySearch %}
                                                            <li class="IDX-searchNavItem IDX-nav-mapsearch">
                                                                <a id="IDX-modifySearch"
                                                                   href="{{ nav.modifySearch }}"
                                                                   class="IDX-btn IDX-btn-default">Modify Search</a>
                                                            </li>

                                                        {% endif %}
                                                        {% if nav.backToResults %}
                                                            <li class="IDX-searchNavItem IDX-nav-mapsearch">
                                                                <a id="IDX-backToResults"
                                                                   href="{{ nav.backToResults }}"
                                                                   class="IDX-btn IDX-btn-default">Back to
                                                                    Results</a>
                                                            </li>

                                                        {% endif %}
                                                        {# tools.displayMortgageCalcLink #}
                                                        {% if parentPtID not in [3, 10] and rntLsePrice == 0 and idxStatus == 'active' %}
                                                            <li id="IDX-detailsHotAction-mortgage">
                                                                <a id="IDX-mortgageLink" href="{{ mortgageLink }}"
                                                                   class="IDX-btn IDX-btn-default">Mortgage Calculator</a>
                                                            </li>
                                                        {% endif %}
                                                    {% endspaceless %}


                                                </ul>
                                            </div><!-- /.navbar-collapse -->
                                        </div><!-- /.container-fluid -->
                                    </nav>
                                </div>
                            {% endblock %}
                            <div id="IDX-detailsMedia">
                                <div id="IDX-primaryPhoto" class="IDX-detailsPhotosWrap">
                                    <a href="#" class="IDX-thumbnail">
                                        <img src="{{ imageData|first.url }}" id="IDX-detailsPrimaryImg"
                                             data-img-index="1"/>
                                    </a>
                                    {% if imageData.totalCount > 1 %}
                                        <a id="IDX-arrow-previous" class="IDX-arrow">
                                            <i class="fa fa-chevron-left"></i>
                                        </a>
                                        <a id="IDX-arrow-next" class="IDX-arrow">
                                            <i class="fa fa-chevron-right"></i>
                                        </a>
                                    {% endif %}
                                </div>
                                <div id="IDX-detailsShowcaseSlides"
                                     style="overflow: hidden; height: auto; position: relative; padding: 8px 30px; max-width: 1620px; overflow-x: hidden; margin: 0 auto;"
                                     class="{% if imageData.totalCount <= 1 %}IDX-hide{% endif %}">
                                    <div class="IDX-carouselWrapper" data-count="{{ imageData.totalCount }}"
                                         style="right: 0;">
                                        {% for key, img in imageData if img.url %}
                                            <a href="#" data-index="{{ loop.index0 }}"
                                               class="IDX-carouselThumb IDX-detailsImage-{{ key }}{% if key == 1 %} IDX-showcaseSlide-active{% endif %}"
                                               style="position: relative">
                                                <img src="/images/ajaxLoadLarge.gif" data-loaded="false"
                                                     data-src="{{ img.url }}"/>
                                            </a>
                                        {% endfor %}
                                    </div>
                                    <div class="IDX-carouselNavWrapper IDX-carouselLeft">
                                        <i class="fa fa-angle-left"></i>
                                    </div>
                                    <div class="IDX-carouselNavWrapper IDX-carouselRight">
                                        <i class="fa fa-angle-right"></i>
                                    </div>
                                </div>

                            </div>
                        </div>


                        <div id="IDX-detailsMainInfo" class="IDX-details-section--right">
                            <!-- image -->
                            {% if imageData.totalCount > 0 %}
                                <div id="IDX-detailsGalleryAction">
                                    <a id="IDX-photoGalleryLink" href="{{ photoGalleryLink }}"
                                       class="btn btn--full-width">
                                        View Photo Gallery<span
                                                id="IDX-photoGalleryCount"> ({{ imageData.totalCount }})</span>
                                    </a>
                                </div>
                            {% endif %}
                            <div class="IDX-panel IDX-panel-default">

                                <div class="IDX-panel-heading">
                                    <div id="IDX-detailsAddress">
                                        <div class="IDX-detailsAddressInfo">
                                            <span>Property Address:</span>
                                            <span class="IDX-detailsAddressNumber">{{ streetNumber }} </span>
                                            <span class="IDX-detailsAddressDirection">{{ streetDirection }} </span>
                                            <span class="IDX-detailsAddressName">{{ streetName }}</span>
                                            {% if unitNumber %}&nbsp;
                                                <span class="IDX-detailsAddressUnitNumber">{{ unitNumber }}</span>
                                            {% endif %}
                                            {% if streetName %}
                                                <span class="IDX-detailsEndAddressComma">,&nbsp;</span>
                                            {% endif %}
                                        </div>
                                        <div class="IDX-detailsAddressLocationInfo">
                                            <span class="IDX-detailsAddressCity">{{ cityName }}</span>,
                                            <span class="IDX-detailsAddressState">{{ state }} </span>
                                            <span class="IDX-detailsAddressStateAbrv">{{ stateAbrv }}</span>
                                            <span class="IDX-detailsAddressZipcode">{{ zipcode }}</span>
                                            {% if zip4 > 0 %}
                                                <span class="IDX-addressZip4">-{{ zip4 }}</span>
                                            {% endif %}

                                        </div>
                                    </div>
                                </div>
                                <div class="IDX-panel-body">
                                    {{ _self.priceField(priceData, priceBeforeReduction|default(null)) }}

                                    {% if pricePerSqFt > 0 %}
                                        {{ _self.field(_context, 'pricePerSqFt', labels.pricePerSqFt, { priceFormat: true }) }}
                                    {% endif %}

                                    {% if idxStatus != 'sold' %}
                                        {{ tools.bankRateTool(displayBankRateEstPayment, mortgagePayment) }}
                                    {% endif %}
                                    {{ _self.field(_context, 'propStatus', labels.propStatus) }}
                                    {{ _self.field(_context, 'soldDate', labels.soldDate, { dateFormat: 'n/d/Y' }) }}
                                    {{ _self.field(_context, 'bedrooms', labels.bedrooms) }}
                                    {{ _self.baths(_context) }}
                                    {{ _self.checkNum(_context, 'sqFt', labels.sqFt) }}
                                    {{ _self.checkNum(_context, 'acres', labels.acres) }}
                                    {% if not contentFields %}
                                        {% set contentFields = {"core": [ "countyName", "subdivision", "yearBuilt", "propType", "propSubType" ]} %}
                                    {% endif %}
                                    {% for divID,fields in contentFields %}
                                        <div id="IDX-contentFields-{{ divID }}" class="IDX-contentFields">
                                            {% for field in fields %}
                                                {{ _self.field(_context, field, attribute(labels, field)) }}
                                            {% endfor %}
                                        </div>
                                    {% endfor %}
                                    {% if featured == 'y' %}
                                        {% include 'mobileFirstFeaturedAgent-1.001.twig' %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                    </div>


                    {# determine if there is a open house #}
                    {% if mediaData.ohCount > 0 %}
                        <div id="IDX-openHouses">
                            <h3 id="IDX-openHouseHeader">Upcoming Open
                                House{% if mediaData.ohCount > 1 %}s{% endif %}</h3>
                            {% for oh in mediaData.oh %}
                                <div class="IDX-openHouseWrapper">
                                    <h4 class="IDX-ohFreeFormDate">{{ oh.freeFormDate }}</h4>
                                    <div class="IDX-openHouse">
                                        <div class="IDX-openHouseTime"><span class="IDX-ohWhen">Time: </span><span
                                                    class="IDX-ohFreeFormTime">{{ oh.freeFormTime }}</span></div>
                                        {% if oh.text %}
                                            <div class="IDX-ohText">{{ oh.text }}</div>{% endif %}
                                        {% if oh.descriptor %}
                                            <div class="IDX-ohDescriptor">{{ oh.descriptor }}</div>{% endif %}
                                        {% if oh.ohLink %}<a href="{{ oh.ohLink }}" class="IDX-ohLink">More
                                            Info</a>{% endif %}
                                        {% if oh.hostedBy %}
                                            <div class="IDX-ohHostedBy">{{ oh.hostedBy }}</div>{% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                            <a id="IDX-ohMoreInfo" href="{{ moreInfoLink }}">Request More Info</a>
                        </div>
                    {% endif %}

                    {% if mediaData.vtCount > 0 %}
                        {% set hasVT = true %}
                    {% endif %}




                    {# The BankRate for standard wrapper. The BankRate for mobile is in mobileFooter twig #}
                    {% if wrapperMode != 'mobile' %}
                        {% if displayBankRateEstPayment == 'y' %}
                            <div id="IDX-BankRateTool-Dialog"
                                 title="Mortgage Rates - {{ cityName }}, {{ stateAbrv }} {{ zipcode }} {{ priceData.value.raw }}">
                                <div id="IDX-mortgageDefaultQueryParameters" class="IDX-hidden">
                                    {"zipcode": "{{ zipcode }}", "price": "{{ priceData.value.raw }}"}
                                </div>
                                <div id="IDX-mortgageRatesContent">
                                    <div id="IDX-mortgageRatesTable">
                                        <div id="IDX-downPayment" class="IDX-mortgageRatesRow">
                                            <span class="IDX-mortgageLabel IDX-textRight">Down Payment</span>
                                            <input type="text" class="IDX-priceField" value="{{ mortgageDownPayment }}"
                                                   data-type="downPayment" placeholder="Down Payment">
                                        </div>
                                        <div id="IDX-creditScore" class="IDX-mortgageRatesRow">
                                            <span class="IDX-mortgageLabel IDX-textRight">Credit Score</span>
                                            <select id="IDX-mortgageRatesFico" name="ficoDllName">
                                                <option value="660|679">660 - 679</option>
                                                <option value="680|699">680 - 699</option>
                                                <option value="700|719">700 - 719</option>
                                                <option value="720|739">720 - 739</option>
                                                <option value="740|1000" selected="">740+</option>
                                            </select>
                                        </div>
                                        <div id="IDX-points" class="IDX-mortgageRatesRow">
                                            <span class="IDX-mortgageLabel IDX-textRight">Points</span>
                                            <select id="IDX-mortgageRatesPoints" name="points">
                                                <option value="All" selected>All</option>
                                                <option value="Zero">Zero</option>
                                                <option value="One">Zero To One</option>
                                                <option value="Two">One To Two</option>
                                            </select>
                                        </div>
                                        <div id="IDX-loanAmount" class="IDX-mortgageRatesRow">
                                            <span class="IDX-mortgageLabel IDX-textRight">Loan Amount</span>
                                            <input type="text" class="IDX-priceField" value="{{ mortgageLoadAmounts }}"
                                                   data-type="loadAmount" placeholder="Loan Amount">
                                        </div>
                                        <div id="IDX-loanType" class="IDX-mortgageRatesRow">
                                            <span class="IDX-mortgageLabel IDX-textRight">Loan Type</span>
                                            <select name="IDX-mortgageRatesProductId" id="IDX-mortgageRatesProductId">
                                                <option value="1" data-legacyID="1">30 yr fixed</option>
                                                <option value="2" data-legacyID="2">15 yr fixed</option>
                                                <option value="3" data-legacyID="3">1 yr ARM</option>
                                                <option value="5" data-legacyID="5">30 yr FHA Mortgage</option>
                                                <option value="6" data-legacyID="6">5/1 ARM</option>
                                                <option value="8" data-legacyID="8">3/1 ARM</option>
                                                <option value="9" data-legacyID="9">7/1 ARM</option>
                                                <option value="10" data-legacyID="10">10/1 ARM</option>
                                                <option value="116" data-legacyID="215">15 yr fixed refi</option>
                                                <option value="117" data-legacyID="216">30 yr fixed refi</option>
                                                <option value="118" data-legacyID="217">1 yr ARM refi</option>
                                                <option value="119" data-legacyID="218">3/1 ARM refi</option>
                                                <option value="120" data-legacyID="219">5/1 ARM refi</option>
                                                <option value="121" data-legacyID="220">7/1 ARM refi</option>
                                                <option value="122" data-legacyID="221">10/1 ARM refi</option>
                                                <option value="156" data-legacyID="265">30 yr FHA refi</option>
                                                <option value="266" data-legacyID="387">20 yr fixed</option>
                                                <option value="267" data-legacyID="388">10 yr fixed</option>
                                                <option value="268" data-legacyID="389">3/1 ARM (interest only)</option>
                                                <option value="269" data-legacyID="390">5/1 ARM (interest only)</option>
                                                <option value="271" data-legacyID="392">20 yr fixed refi</option>
                                                <option value="272" data-legacyID="393">10 yr fixed refi</option>
                                                <option value="304" data-legacyID="425">3/1 ARM refi (interest only)
                                                </option>
                                                <option value="305" data-legacyID="426">5/1 ARM refi (interest only)
                                                </option>
                                                <option value="322" data-legacyID="447">7/1 ARM (interest only)</option>
                                                <option value="323" data-legacyID="448">7/1 ARM refi (interest only)
                                                </option>
                                                <option value="324" data-legacyID="449">30 year VA Mortgage Loan
                                                </option>
                                                <option value="325" data-legacyID="450">30 year VA mortgage refi
                                                </option>
                                                <option value="427" data-legacyID="565">30 yr fixed (interest only)-0
                                                    point
                                                </option>
                                                <option value="428" data-legacyID="566">40 yr fixed-0 point</option>
                                            </select>
                                        </div>
                                        <div class="IDX-mortgageRatesRow">
                                            <button id="searchBankRate" class="IDX-btn IDX-btn-default">Search</button>
                                        </div>
                                        <hr>
                                        <div id="IDX-bankRateContent"></div>
                                    </div>
                                    <a href="#" id="IDX-mortgageShowAllRates">Show All Rates</a>
                                </div>
                                <div id="IDX-BankRateDataloading"><img src='/images/ajaxLoadBar.gif'/></div>
                            </div>
                        {% endif %}
                    {% endif %}
                </div>
                {% if missingProperty %}
                {% elseif propArchived %}
                {% elseif invalidMLS %}
                {% else %}
                    <div class="IDX-description-container">
                        <div id="IDX-description" class="IDX-well"
                             style="background: url({{ imageData|first.url }}) no-repeat center; background-attachment: fixed; background-size: cover;">
                            <h4 id="IDX-description-headline">
                                Property Description
                            </h4>
                            <p>{{ tools.remarks }}</p>
                        </div>
                    </div>

                {% endif %}

                {% block idxDetailsSubContent %}
                {# based on settings passed check for maps or other widgets to include here #}
                {% if clientRules.detailsMapType != 'none' and clientRules.detailsMapLocation == 'beforeFields' %}
                    <div id="IDX-mapContainer" class="IDX-well">
                        {% if latitude and longitude %}
                            {% if idxStatus == 'sold' %}
                                {% set propCat='soldPending' %}
                            {% elseif idxStatus != null %}
                                {% set propCat=idxStatus %}
                            {% else %}
                                {% set propCat='active' %}
                            {% endif %}

                            <div id="IDX-detailsMap">
                                <div
                                        id="IDX-map"
                                        class="IDX-detailsMap"
                                        data-lat="{{ latitude }}"
                                        data-lng="{{ longitude }}"
                                        data-price="{{ priceData.value.raw }}"
                                        data-idxStatus="{{ idxStatus }}"
                                        data-idxid="{{ idxid }}"
                                        data-listingid="{{ listingID }}"
                                        data-mlsptid="{{ mlsPtID }}"
                                        data-propcat="active"
                                >
                                </div>
                            </div>
                            {# include our new pins/clusters #}
                            {% include 'leaflet-1.000.twig' %}
                        {% endif %}
                    </div>
                {% endif %}
                {% if clientRules.displayWalkscoreWidget == 'beforeFields' %}
                    {{ tools.walkscore }}
                {% endif %}
                {# display the field containers #}
                <div id="IDX-fieldsWrapper">
                    {% for container in containerData %}
                        {% set class = 'IDX-fieldContainer ' %}
                        {% if container.containerColumns == 1 %}
                            {% set class = class ~ 'IDX-fieldOneColumn' %}
                        {% else %}
                            {% set class = class ~ 'IDX-fieldTwoColumn' %}
                        {% endif %}
                        {% if container.containerID == 'hopoZoning' %}
                            {% set class = class ~ ' IDX-hopoZoning' %}
                        {% endif %}
                        {% if container.emptyContainer %}
                            {% set class = class ~ ' IDX-emptyFieldContainer' %}
                        {% endif %}

                        <div id="IDX-detailsContainer-{{ idxID }}-{{ layoutID }}-{{ container.containerID }}"
                             class="{{ class }} IDX-panel IDX-panel-default">
                            <div class="IDX-panel-heading" role="tab"
                                 id="IDX-panel-heading-{{ idxID }}-{{ layoutID }}-{{ container.containerID }}">
                                <h4 class="IDX-panel-title">
                                    <a class="IDX-panel-collapse-toggle IDX-collapsed" data-toggle="idx-collapse"
                                       href="#IDX-panel-body-{{ idxID }}-{{ layoutID }}-{{ container.containerID }}"
                                       aria-expanded="false"
                                       aria-controls="IDX-panel-body-{{ idxID }}-{{ layoutID }}-{{ container.containerID }}">
                                        {{ container.containerTitle }}
                                        <span class="IDX-icon-arrow-up"></span>
                                    </a>
                                </h4>
                            </div>
                            <div id="IDX-panel-body-{{ idxID }}-{{ layoutID }}-{{ container.containerID }}"
                                 class="IDX-panel-collapse IDX-collapse" role="tabpanel"
                                 aria-labelledby="IDX-panel-heading-{{ idxID }}-{{ layoutID }}-{{ container.containerID }}"
                                 aria-expanded="false">
                                <div class="IDX-panel-body">
                                    {{ _self.fieldContainerSide(container.fields.left,'left') }}

                                    {% if container.containerColumns == 2 %}
                                        {{ _self.fieldContainerSide(container.fields.right,'right') }}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    {% if displayGreatSchools %}
                        <div id="IDX-detailsContainer-greatSchools" class="IDX-panel IDX-panel-default">
                            <div class="IDX-panel-heading" role="tab">
                                <h4 class="IDX-panel-title">
                                    <a class="IDX-panel-collapse-toggle IDX-collapsed" data-toggle="idx-collapse"
                                       href="#IDX-panel-body-greatSchools" aria-expanded="false"
                                       aria-controls="IDX-panel-body-greatSchools">
                                        Area Info
                                        <span class="IDX-icon-arrow-up"></span>
                                    </a>
                                </h4>
                            </div>
                            <div class="IDX-panel-body">
                                {{ tools.greatSchools({ id: 'IDX-panel-body-greatSchools', class: 'IDX-panel-collapse IDX-collapse', role: 'tabpanel', hideTitle: true }) }}
                            </div>
                        </div>
                    {% endif %}
                </div>
                {# dislcaimer / courtesy / css selector #}
                {% if missingProperty == false and propArchived == false %}
                    <div class="disclaimer-container">
                        {% include 'singleMlsDisclaimers-1.000.twig' %}
                    </div>
                {% endif %}

                {# Similar Listings #}
                {% if clientRules.displaySimilarListingsOnDetailsPage == 'y' %}
                    {% include 'similarProperties-1.000.twig' %}
                {% endif %}
            </div>

            <div class="detailsWrapper--right">

                <div class="mat-form">
                    <div class="mat-form--header"><a href="tel:412-444-5181"><i class="fa fa-phone"></i>&nbsp;
                            412-444-5181
                        </a></div>
                    <div class="mat-form--body">
                        <div class="element-wrapper"><input type="text" name="name" id="cfc_name" required=""><label for="name">First
                                Name:</label></div>
                        <div class="element-wrapper"><input type="text" name="last_name" id="cfc_last_name" required=""><label for="lastName">Last
                                Name:</label></div>
                        <div class="element-wrapper"><input type="email" name="email" id="cfc_email" required=""><label
                                    for="email">Email:</label></div>
                        <div class="element-wrapper"><input type="text" name="phone" id="cfc_phone" required=""><label
                                    for="phone">Phone:</label></div>
                        <div class="element-wrapper with--checkbox">
                            <label class="checkbox path">
                                <input type="checkbox" id="cfc_request_info">
                                <svg viewBox="0 0 21 21">
                                    <path d="M5,10.75 L8.5,14.25 L19.4,2.3 C18.8333333,1.43333333 18.0333333,1 17,1 L4,1 C2.35,1 1,2.35 1,4 L1,17 C1,18.65 2.35,20 4,20 L17,20 C18.65,20 20,18.65 20,17 L20,7.99769186"></path>
                                </svg>
                                &nbsp; Request Info
                            </label>
                        </div>
                        <div class="element-wrapper with--checkbox">
                            <label class="checkbox path" id="clickCustomMessage">
                                <input type="checkbox" id="sendCustomMessage">
                                <svg viewBox="0 0 21 21">
                                    <path d="M5,10.75 L8.5,14.25 L19.4,2.3 C18.8333333,1.43333333 18.0333333,1 17,1 L4,1 C2.35,1 1,2.35 1,4 L1,17 C1,18.65 2.35,20 4,20 L17,20 C18.65,20 20,18.65 20,17 L20,7.99769186"></path>
                                </svg>
                                &nbsp; Custom Message
                            </label>
                        </div>
                        <input type="hidden" value="{{ listingID }}" id="listingIdHidden">
                        <div class="element-wrapper" id="customMessageContainer">
                            <textarea id="contactCustomMessage" class="form__field" rows="6"></textarea>
                            <label for="contactCustomMessage" class="form__label">Your Message</label>
                        </div>
                    </div>
                    <div class="element-wrapper flex-centered">
                        <button id="sendContactForm" class="contact-btn--send btn-cta btn">Send</button>
                    </div>
                    <div class="mat-form--footer">
                        <a href="tel:412-444-5181">
                            <i class="fa fa-building"></i>&nbsp;
                            Fifth & Grant
                        </a>
                    </div>
                </div>

            </div>
            {# based on settings passed check for maps or other widgets to include here #}
            {% if clientRules.detailsMapType != 'none' and clientRules.detailsMapLocation == 'afterFields' %}
                {% if idxStatus == 'sold' %}
                    {% set propCat='soldPending' %}
                {% elseif idxStatus != null %}
                    {% set propCat=idxStatus %}
                {% else %}
                    {% set propCat='active' %}
                {% endif %}
                {# include our new pins/clusters #}
                {% include 'leaflet-1.000.twig' %}
                {{ tools.map }}
            {% endif %}
            {% if clientRules.displayWalkscoreWidget == 'afterFields' %}
                {{ tools.walkscore }}
            {% endif %}
            {% endblock %}
            {% endif %}
        </div>






        {# Page Footer Content #}
        {# Content we'll need on pages #}
        {% if mobileViewingFull %}
            <div class="IDX-swapMobileView"><a id="IDX-viewMobileSite" href="?mobilesite{{ searchString }}&mobile=true">View
                Mobile Site</a></div>{% endif %}
        {% if global.mobile %}
            <div class="IDX-swapMobileView"><a href="?fullsite{{ searchString }}" id="IDX-viewFullSite" rel="external">View
                Full Site</a></div>{% endif %}
    {% endspaceless %}

    {% include 'facebookPrecache-1.000.twig' %}
{% endblock %}

{% macro priceField(price, oldPrice) %}
    {% spaceless %}
        {# add rules #}
        {% set rules = attribute(mlsRules, idxID) %}
        <div class="IDX-field-{{ price.field }} IDX-field-price IDX-field">
            <span class="IDX-label">{{ price.label }}</span>
            <span class="IDX-text">{{ price.value.formatted }}</span>
            {% if oldPrice %}
                {% import 'utilities-1.000.twig' as utilities %}
                {# Set the difference in price. #}
                {% set diff = oldPrice - price.value.raw %}
                {{ utilities.priceDropComponent(diff, price.label) }}
            {% endif %}
        </div>
    {% endspaceless %}
{% endmacro %}
{# same in the mobileFirstResults #}
{% macro field(listing,field,display,options) %}
    {% if attribute(listing,field) is defined %}
        {% set value = attribute(listing,field) %}
        {% if value %}
            {% if options.numberFormat %}
                {% set value = value|number_format(options.numberFormat)|replace({'.00':''}) %}
            {% endif %}
            {% if options.dateFormat %}
                {% set value = value|date(options.dateFormat) %}
            {% endif %}
            {% if options.priceFormat %}
                {% set value = '$' ~ value|number_format(2) %}
            {% endif %}
            <div class="IDX-field-{{ field }} IDX-field {% if isNumeric(value) and value == 0 or value is empty %} IDX-zero{% endif %}">
                {% if options.labelAfter %}
                    <span class="IDX-text">{{ value }}</span>
                    {% if display %}<span class="IDX-label">{{ display }}</span>{% endif %}
                {% else %}
                    {% if display %}<span class="IDX-label">{{ display }}</span>{% endif %}
                    <span class="IDX-text">{{ value }}</span>
                {% endif %}
            </div>
        {% endif %}
    {% endif %}
{% endmacro %}
{% macro checkNum(listing, field, display) %}
    {% if attribute(listing, field) > 0 %}
        <div class="IDX-field-{{ field }} IDX-field">
            <span class="IDX-label">{{ display }}</span>
            {% spaceless %}
                <span class="IDX-text">
                {% if field == 'sqFt' %}
                    {{ attribute(listing, field) }}
                {% else %}
                    {{ attribute(listing, field) }}
                {% endif %}
                </span>
            {% endspaceless %}
        </div>
    {% endif %}
{% endmacro %}
{# baths fields #}
{% macro baths(listing) %}
    {% set fb = attribute(listing, 'fullBaths') %}
    {% set pb = attribute(listing, 'partialBaths') %}
    {% set tb = attribute(listing, 'totalBaths') %}
    {% import _self as this %}

    {% if fb > 0 and pb > 0 %}
        {{ this.field(listing,'totalBaths',labels.totalBaths) }}
        {{ this.field(listing,'fullBaths',labels.fullBaths) }}
        {{ this.field(listing,'partialBaths',labels.partialBaths) }}
    {% elseif fb > 0 %}
        {{ this.field(listing,'totalBaths',labels.totalBaths) }}
        {{ this.field(listing,'fullBaths',labels.fullBaths) }}
    {% elseif tb > 0 and pb > 0 %}
        {{ this.field(listing,'totalBaths',labels.totalBaths) }}
        {{ this.field(listing,'partialBaths',labels.partialBaths) }}
    {% elseif tb > 0 %}
        {{ this.field(listing,'totalBaths',labels.totalBaths) }}
    {% endif %}
{% endmacro %}
{% macro fieldContainerSide(fields,side) %}
    {% if fields > 0 %}
        <div class="IDX-fieldContainerList IDX-fieldContainerList{{ side|capitalize }}">
            {% for field, label in fields %}

                {% set data = attribute(_context,field) %}
                {% if clientRules.showEmptyDetailData == 'n' and (isEmpty(data) or data == '0.00') %}
                    {# we are not to show empty data, so dont show anything #}
                {% else %}
                    {# only display field with label #}
                    {% if field in labels|keys %}
                        <div id="IDX-field-{{ field }}" class="IDX-field">
                            <span class="IDX-label">{{ attribute(labels, field) }}</span>
                            <span class="IDX-text">
                        {% if isArray(data) %}
                            {{ data|join(', ') }}
                        {% else %}
                            {{ data }}
                        {% endif %}
                        </span>
                        </div>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </div>
    {% endif %}
{% endmacro %}

<div class="sm-contact-bar">
    <a href="#" class="">
        <i class="fa fa-phone"></i>
    </a>
    <span class="contact-mail">
        <i class="fa fa-envelope"></i>
    </span>
</div>